{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Materialize Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Materialize compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

    <!-- Custom fonts -->
    <link rel="stylesheet" href="{% static 'css/custom-fonts.css' %}" type="text/css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/base.css' %}" type="text/css">

    {% block extra_css %}
    {% endblock %}

    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <!-- Initialize Materialize -->
    <script src="{% static 'js/materialize.js' %}" type="text/javascript"></script>

    {% block extra_js %}
    {% endblock %}

    <title>NatureTrust {% block extra_title %}{% endblock %}</title>
</head>
<body>
    <header>
        <nav>
            <div class="nav-wrapper">
                <a href="#" data-target="sidenav-main" class="sidenav-trigger show-on-large"><i class="material-icons">menu</i></a>
                <a href="{% url 'home' %}" class="brand-logo title hide-on-med-and-down">NatureTrust</a>
                <ul class="right">
                    <li><a href="{% url 'games' %}" class="btn purchase-btn btn-folded-corners" id="nav-purchase-btn">Buy Games</a></li>
                    <li><a href="#shoppingCartNav" class="sidenav-trigger show-on-large">
                        <img src="{{ MEDIA_URL }}icons/shopping-cart.svg" alt="Shopping cart icon" id="shopping-cart-icon">
                    </a></li>
                </ul>
            </div>
        </nav>
        <ul class="sidenav" id="sidenav-main">
            <li><a href="#!" class="sidenav-close"><i class="material-icons white-text">close</i></a></li>
            <li><h4 class="title">NatureTrust</h4></li>
            <li class="title"><a href="{% url 'games' %}">Buy Games</a></li>
            <li class="title"><a href="#!">About Us</a></li>
            <li class="title"><a href="#!">Adoption Packs</a></li>
            <li class="title"><a href="#!">Contact Us</a></li>
        </ul>
        {% include 'includes/cart-nav.html' %}
    </header>

    {% block content %}
    {% endblock %}

    {% block postloadjs %}
    <script type="text/javascript">
        $(document).ready(function() {
            // Disable +/- buttons outside 1-99 range
            function handleEnableDisable(itemId) {
                var currentValue = parseInt($(`#id-qty_${itemId}`).val());
                var minusDisabled = currentValue < 2;
                var plusDisabled = currentValue > 98;
                $(`#decrement-qty_${itemId}`).prop('disabled', minusDisabled);
                $(`#increment-qty_${itemId}`).prop('disabled', plusDisabled);
            };

            var allQtyInputs = $('.qty_input');
            for(var i = 0; i < allQtyInputs.length; i++){
                var itemId = $(allQtyInputs[i]).data('item_id');
                handleEnableDisable(itemId);
            };

            $('.qty_input').change(function() {
                var itemId = $(this).data('item_id');
                handleEnableDisable(itemId);
            });

            // Increment quantity
            $('.increment-qty').click(function(e) {
                e.preventDefault();
                var closestInput = $(this).closest('.qty-btn').find('.qty-val')[0];
                // Cache the value that's currently in it into a variable called currentValue
                var currentValue = parseInt($(closestInput).val());

                // Use that variable to set the input boxes new value to the current value plus one
                $(closestInput).val(currentValue + 1);
                var itemId = $(this).data('item_id');
                handleEnableDisable(itemId);

                // Show update button when increment button is clicked
                itemId = $(this).attr('id');
                idNumber = itemId.split('qty_');
                idNumber = idNumber[1]
                $(`#updateQtyNav-${idNumber}`).fadeIn(400);
                $(`#updateQty-${idNumber}`).fadeIn(400);
            });

            // Decrement quantity
            $('.decrement-qty').click(function(e) {
                e.preventDefault();
                var closestInput = $(this).closest('.qty-btn').find('.qty-val')[0];
                // Cache the value that's currently in it into a variable called currentValue
                var currentValue = parseInt($(closestInput).val());

                if ($(closestInput).val() != 1) {
                    // Use that variable to set the input boxes new value to the current value minus one
                    $(closestInput).val(currentValue - 1);
                    var itemId = $(this).data('item_id');
                    handleEnableDisable(itemId);

                    // Show update button when decrement button is clicked
                    itemId = $(this).attr('id');
                    idNumber = itemId.split('qty_');
                    idNumber = idNumber[1]
                    $(`#updateQty-${idNumber}`).fadeIn(400);
                };
            });
        });
    </script>
    {% endblock %}
</body>
</html> 